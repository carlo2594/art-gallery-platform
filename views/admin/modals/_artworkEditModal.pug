// Modal de edición de obra (usa variable local `a`, y `isAdmin` y `status` si están disponibles)
.modal.fade(id=`adminEditArtwork-${a._id}` tabindex='-1' aria-labelledby=`adminEditArtworkLabel-${a._id}` aria-hidden='true')
  .modal-dialog.modal-lg
    .modal-content
      .modal-header
        h5.modal-title(id=`adminEditArtworkLabel-${a._id}`) Editar obra - #{a.title}
        button.btn-close(type='button' data-bs-dismiss='modal' aria-label='Close')
      .modal-body
        form.admin-edit-artwork-form(id=`adminEditArtworkForm-${a._id}` data-artwork-id=a._id data-initial-status=(status || 'draft') data-initial-availability=a.availability enctype='multipart/form-data')
          // Básicos
          .row.g-3
            .col-md-8
              label.form-label Título
              input.form-control(type='text', name='title', value=a.title)
            .col-md-4
              label.form-label Estado
              .form-control-plaintext
                span.badge(class=(status === 'approved' ? 'text-bg-success' : (status === 'under_review' ? 'text-bg-warning' : (status === 'rejected' ? 'text-bg-danger' : 'text-bg-secondary'))))= status || 'draft'
          .mb-3
            label.form-label Descripción
            textarea.form-control(name='description' rows='3')= a.description || ''
          // Imagen principal
          .mb-3
            label.form-label Imagen principal
            .d-flex.align-items-center.gap-3
              - const imgSrc = a.imageUrl || ''
              img.admin-artworks-image-preview.img-thumbnail(src=imgSrc, alt=`Imagen de ${a.title}` style='width:64px;height:64px;object-fit:cover;' hidden=!a.imageUrl)
              .d-flex.flex-wrap.gap-2
                // Input de archivo; si no se elige, se conserva la imagen existente
                input.form-control.form-control-sm.admin-artworks-image-input(type='file', name='image', accept='image/*')
                button.btn.btn-sm.btn-primary.admin-artworks-image-upload-btn(type='button') Subir
                button.btn.btn-sm.btn-outline-danger.admin-artworks-image-remove-btn(type='button') Quitar
            small.text-muted.mt-1 Selecciona una imagen y presiona "Subir".
          .row.g-3
            .col-md-6
              label.form-label Artista
              input.form-control(type='text', value=(a.artist && a.artist.name) || '""', readonly)
            .col-md-6
              label.form-label Fecha de finalización
              - const completedVal = a.completedAt ? new Date(a.completedAt).toISOString().slice(0,10) : ''
              input.form-control(type='date', name='completedAt', value=completedVal, disabled=!isAdmin)
          // Técnica y medidas
          .row.g-3
            .col-md-4
              label.form-label Tipo
              input.form-control(type='text', name='type', value=a.type || '')
            .col-md-4
              label.form-label Técnica
              input.form-control(type='text', name='technique', value=a.technique || '')
            .col-md-2
              label.form-label Ancho (cm)
              input.form-control(type='number', name='width_cm', min='0', step='1', value=a.width_cm)
            .col-md-2
              label.form-label Alto (cm)
              input.form-control(type='number', name='height_cm', min='0', step='1', value=a.height_cm)
          // Precio y disponibilidad
          .row.g-3
            .col-md-4
              label.form-label Precio (USD)
              - const priceUSD = (typeof a.price_cents === 'number') ? (a.price_cents/100).toFixed(2) : ''
              input.form-control(type='number', name='price_usd', min='0', step='0.01', value=priceUSD)
            .col-md-4
              label.form-label Disponibilidad
              select.form-select(name='availability', disabled=!isAdmin)
                option(value='not_for_sale' selected=a.availability==='not_for_sale') No a la venta
                option(value='for_sale' selected=a.availability==='for_sale') En venta
                option(value='reserved' selected=a.availability==='reserved') Reservada
                // Ocultamos 'sold' en el panel admin (requiere datos de venta)
                option(value='on_loan' selected=a.availability==='on_loan') En préstamo
            .col-md-4
              label.form-label Reservada hasta
              - const reservedVal = a.reservedUntil ? new Date(a.reservedUntil).toISOString().slice(0,10) : ''
              input.form-control(type='date', name='reservedUntil', value=reservedVal, disabled=!isAdmin)
          .row.g-3
            .col-md-4
              label.form-label Favoritos (solo lectura)
              input.form-control(type='number', value=a.favoritesCount || 0, readonly)
            .col-md-4
              label.form-label Vistas (solo lectura)
              input.form-control(type='number', value=a.views || 0, readonly)
            .col-md-4
              label.form-label Creada
              input.form-control(type='text', value=new Date(a.createdAt).toLocaleString('es-ES'), readonly)
      .modal-footer
        button.btn.btn-secondary(type='button' data-bs-dismiss='modal') Cerrar
        // Nota: requiere JS para guardar
        button.btn.btn-primary.admin-artworks-save(type='submit' form=`adminEditArtworkForm-${a._id}`) Guardar cambios
