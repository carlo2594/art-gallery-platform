// views/public/_exhibitionPagination.pug
// Requiere: exhibitionPage, exhibitionTotalPages, q, (opcional: search, tab)
// Uso: include _exhibitionPagination.pug
if typeof exhibitionPage !== 'undefined' && typeof exhibitionTotalPages !== 'undefined' && exhibitionTotalPages > 1
  - var navAttrs = { class: 'mt-4 mb-4 d-flex justify-content-center', id: 'pager-exposiciones', 'aria-label': 'Paginaci√≥n exposiciones' };
  - if (typeof tab !== 'undefined') navAttrs['data-tab'] = tab;
  nav(&attributes(navAttrs))
    ul.pagination-ox.pagination-lg
      // Previous button
      li.page-item(class=exhibitionPage === 1 ? 'disabled' : '')
        a.page-link(
          href=(typeof tab !== 'undefined' && typeof search !== 'undefined'
            ? `?q=${search || ''}&tab=${tab}&exhibitionPage=${exhibitionPage-1}${q && q.sort ? `&sort=${q.sort}` : ''}${q && q.type ? `&type=${q.type}` : ''}${q && q.minYear ? `&minYear=${q.minYear}` : ''}${q && q.maxYear ? `&maxYear=${q.maxYear}` : ''}`
            : `?exhibitionPage=${exhibitionPage-1}${q && q.sort ? `&sort=${q.sort}` : ''}${q && q.type ? `&type=${q.type}` : ''}${q && q.minYear ? `&minYear=${q.minYear}` : ''}${q && q.maxYear ? `&maxYear=${q.maxYear}` : ''}`)
          aria-label="Anterior")
          span(aria-hidden="true") &laquo;
      // Page numbers (show up to 5 pages, center current)
      - var startPage = Math.max(1, exhibitionPage - 2);
      - var endPage = Math.min(exhibitionTotalPages, exhibitionPage + 2);
      - if (endPage - startPage < 4) {
      -   if (startPage === 1) endPage = Math.min(exhibitionTotalPages, startPage + 4);
      -   else if (endPage === exhibitionTotalPages) startPage = Math.max(1, endPage - 4);
      - }
      each p in Array(endPage - startPage + 1).fill().map((_,i) => startPage + i)
        li.page-item(class=p === exhibitionPage ? 'active' : '')
          a.page-link(
            href=(typeof tab !== 'undefined' && typeof search !== 'undefined'
              ? `?q=${search || ''}&tab=${tab}&exhibitionPage=${p}${q && q.sort ? `&sort=${q.sort}` : ''}${q && q.type ? `&type=${q.type}` : ''}${q && q.minYear ? `&minYear=${q.minYear}` : ''}${q && q.maxYear ? `&maxYear=${q.maxYear}` : ''}`
              : `?exhibitionPage=${p}${q && q.sort ? `&sort=${q.sort}` : ''}${q && q.type ? `&type=${q.type}` : ''}${q && q.minYear ? `&minYear=${q.minYear}` : ''}${q && q.maxYear ? `&maxYear=${q.maxYear}` : ''}`)
            aria-current=(p === exhibitionPage ? 'page' : false))= p
      // Next button
      li.page-item(class=exhibitionPage === exhibitionTotalPages ? 'disabled' : '')
        a.page-link(
          href=(typeof tab !== 'undefined' && typeof search !== 'undefined'
            ? `?q=${search || ''}&tab=${tab}&exhibitionPage=${exhibitionPage+1}${q && q.sort ? `&sort=${q.sort}` : ''}${q && q.type ? `&type=${q.type}` : ''}${q && q.minYear ? `&minYear=${q.minYear}` : ''}${q && q.maxYear ? `&maxYear=${q.maxYear}` : ''}`
            : `?exhibitionPage=${exhibitionPage+1}${q && q.sort ? `&sort=${q.sort}` : ''}${q && q.type ? `&type=${q.type}` : ''}${q && q.minYear ? `&minYear=${q.minYear}` : ''}${q && q.maxYear ? `&maxYear=${q.maxYear}` : ''}`)
          aria-label="Siguiente")
          span(aria-hidden="true") &raquo;