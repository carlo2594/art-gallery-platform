extends ../layouts/public

block content
  main.main-content
    // Hero Section - Estilo Google Arts & Culture
    section.artist-profile-hero.position-relative(style="min-height: 100vh; overflow: hidden;")
      // Imagen de fondo
      .hero-background.position-absolute.w-100.h-100
        if artist.profileImage
          img.hero-bg-image.w-100.h-100(
            src=artist.profileImage, 
            alt=artist.name,
            style="object-fit: cover; object-position: center;"
          )
        else
          .hero-bg-placeholder.w-100.h-100(
            style="background: linear-gradient(135deg, var(--ox-blue) 0%, var(--ox-orange) 50%, var(--ox-yellow) 100%);"
          )
      
      // Overlay oscuro
      .hero-overlay.position-absolute.w-100.h-100(
        style="background: linear-gradient(0deg, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.4) 50%, rgba(0,0,0,0.2) 100%);"
      )
      
      // Contenido superpuesto
      .hero-content.position-absolute.bottom-0.start-0.w-100(style="z-index: 10;")
        .container
          .row
            .col-lg-8
              .artist-hero-info.text-white.pb-5
                h1.hero-title.display-2.fw-bold.mb-3(style="font-family: var(--font-title); text-shadow: 0 2px 8px rgba(0,0,0,0.5);")= artist.name
                
                if artist.createdAt
                  h2.hero-subtitle.h4.mb-4.text-white-50(style="font-family: var(--font-subtitle); font-weight: 300; text-shadow: 0 1px 4px rgba(0,0,0,0.5);")= `Miembro desde ${new Date(artist.createdAt).getFullYear()}`
                
                if artist.bio
                  p.hero-bio.lead.mb-4.text-white-75(style="font-family: var(--font-subtitle); font-style: italic; line-height: 1.5; text-shadow: 0 1px 4px rgba(0,0,0,0.5); max-width: 600px;")= artist.bio
                
                // Información adicional compacta
                .hero-meta.d-flex.flex-wrap.gap-4.mb-4
                  if artist.location
                    .meta-item.d-flex.align-items-center
                      i.fas.fa-map-marker-alt.me-2.text-warning
                      span.text-white-75= artist.location
                  
                  if artist.website
                    .meta-item
                      a.text-warning.text-decoration-none(href=artist.website, target="_blank", rel="noopener")
                        i.fas.fa-globe.me-2
                        span Sitio web
                  
                  // Redes sociales
                  if artist.social && artist.social.instagram
                    .meta-item
                      a.text-warning.text-decoration-none(href=`https://instagram.com/${artist.social.instagram}`, target="_blank", rel="noopener")
                        i.fab.fa-instagram.me-2
                        span Instagram
                  
                  if artist.social && artist.social.x
                    .meta-item
                      a.text-warning.text-decoration-none(href=`https://x.com/${artist.social.x}`, target="_blank", rel="noopener")
                        i.fab.fa-x.me-2
                        span X
                  
                  if artist.social && artist.social.facebook
                    .meta-item
                      a.text-warning.text-decoration-none(href=`https://facebook.com/${artist.social.facebook}`, target="_blank", rel="noopener")
                        i.fab.fa-facebook.me-2
                        span Facebook
                
                // Acciones del usuario
                .hero-actions.d-flex.gap-3
                  button.btn.btn-outline-light.btn-lg.px-4(style="border-radius: 2rem; backdrop-filter: blur(10px); background: rgba(255,255,255,0.1);")
                    i.fas.fa-heart.me-2
                    | Seguir
                  
                  button.btn.btn-outline-light.btn-lg.px-4(style="border-radius: 2rem; backdrop-filter: blur(10px); background: rgba(255,255,255,0.1);")
                    i.fas.fa-share.me-2
                    | Compartir
            
            .col-lg-4
              // Estadísticas flotantes
              .stats-floating.text-white.pb-5
                .row.g-3
                  .col-6
                    .stat-item.text-center.p-3(style="backdrop-filter: blur(10px); background: rgba(255,255,255,0.1); border-radius: 1rem; border: 1px solid rgba(255,255,255,0.2);")
                      .stat-number.h2.fw-bold.mb-0.text-warning= stats.totalArtworks
                      .stat-label.small.text-white-75 Obras
                  
                  .col-6
                    .stat-item.text-center.p-3(style="backdrop-filter: blur(10px); background: rgba(255,255,255,0.1); border-radius: 1rem; border: 1px solid rgba(255,255,255,0.2);")
                      .stat-number.h2.fw-bold.mb-0.text-warning= stats.totalViews.toLocaleString()
                      .stat-label.small.text-white-75 Vistas
                  
                  if stats.avgPrice > 0
                    .col-6
                      .stat-item.text-center.p-3(style="backdrop-filter: blur(10px); background: rgba(255,255,255,0.1); border-radius: 1rem; border: 1px solid rgba(255,255,255,0.2);")
                        .stat-number.h3.fw-bold.mb-0.text-warning= `$${Math.round(stats.avgPrice).toLocaleString()}`
                        .stat-label.small.text-white-75 Promedio
                  
                  .col-6
                    .stat-item.text-center.p-3(style="backdrop-filter: blur(10px); background: rgba(255,255,255,0.1); border-radius: 1rem; border: 1px solid rgba(255,255,255,0.2);")
                      .stat-number.h3.fw-bold.mb-0.text-warning= stats.techniques.length
                      .stat-label.small.text-white-75 Técnicas

    // Sección de obras del artista
    if artworks && artworks.length > 0
      section.artist-artworks.py-5(style="background: #f8f9fa;")
        .container
          .row.mb-5
            .col-12.text-center
              h2.section-title.display-5.fw-bold.mb-3(style="color: var(--ox-blue); font-family: var(--font-title);")= `Obras de ${artist.name}`
              p.lead.text-muted= `Mostrando ${artworks.length} de ${totalArtworks} obras de este talentoso artista`

        // Filtros solo visibles si hay obras (cantidad > 0)
        if totalArtworks > 0
          section.filters-toolbar.py-2
            .container-xxl.d-flex.align-items-center.flex-wrap.gap-2
              // Set variables before including the filter fragment
              - var q = typeof q !== 'undefined' ? q : {};
              - var techniques = typeof techniques !== 'undefined' ? techniques : [];
              - var priceBounds = typeof priceBounds !== 'undefined' ? priceBounds : {};
              - var appliedPrice = typeof appliedPrice !== 'undefined' ? appliedPrice : {};
              - var actionUrl = `/artists/${artist.slug || artist._id}`;
              include _artworkFilters.pug
        
        .container-xxl.artworks-flex
          if artworks && artworks.length
            .artworks-grid-paginate
              include _artworkGrid.pug
              include _artworkPagination.pug
          else
            h3.h5.mt-4.text-muted No se encontraron obras con estos filtros.

    else
      // No hay obras (puede ser por filtros o porque realmente no tiene obras)
      section.no-artworks.py-5.text-center
        .container
          h2.section-title.display-5.fw-bold.mb-3(style="color: var(--ox-blue); font-family: var(--font-title);")= `Obras de ${artist.name}`
          
          // Mostrar filtros si hay obras del artista pero están filtradas
          if stats.totalArtworks > 0
            section.filters-toolbar.py-2.mb-4
              .container-xxl.d-flex.align-items-center.flex-wrap.gap-2
                // Set variables before including the filter fragment
                - var q = typeof q !== 'undefined' ? q : {};
                - var techniques = typeof techniques !== 'undefined' ? techniques : [];
                - var priceBounds = typeof priceBounds !== 'undefined' ? priceBounds : {};
                - var appliedPrice = typeof appliedPrice !== 'undefined' ? appliedPrice : {};
                - var actionUrl = `/artists/${artist.slug || artist._id}`;
                include _artworkFilters.pug
          
          .row.justify-content-center
            .col-lg-6
              i.fas.fa-palette.fa-4x.text-muted.mb-4
              if stats.totalArtworks > 0
                h3.h4.mb-3.text-muted No se encontraron obras con estos filtros
                p.text-muted Prueba ajustar los filtros o
                  |  
                  a(href=actionUrl) limpiar todos los filtros
                  |  para ver todas las obras de #{artist.name}
              else
                h3.h4.mb-3.text-muted= `${artist.name} aún no tiene obras publicadas`
                p.text-muted Este artista está preparando su portfolio. ¡Vuelve pronto para ver sus creaciones!

    // Botón para volver
    section.back-navigation.py-4
      .container
        .row
          .col-12.text-center
            a.btn.btn-outline-primary.btn-lg(href="/artists", style="border-radius: 2rem; padding: 0.75rem 2rem;")
              i.fas.fa-arrow-left.me-2
              | Volver a Artistas