// views/public/exhibitions/_exhibitionPagination.pug
// Requiere: exhibitionPage, exhibitionTotalPages, q, (opcional: search, tab)
if typeof exhibitionPage !== 'undefined' && typeof exhibitionTotalPages !== 'undefined' && exhibitionTotalPages > 1
  - var navAttrs = { class: 'mt-4 mb-4 d-flex justify-content-center', id: 'pager-exhibitions', 'aria-label': 'Exhibit pagination' };
  - if (typeof tab !== 'undefined') navAttrs['data-tab'] = tab;
  nav(&attributes(navAttrs))
    ul.pagination-ox.pagination-lg
      li.page-item(class=exhibitionPage === 1 ? 'disabled' : '')
        a.page-link(
          href=(typeof tab !== 'undefined' && typeof search !== 'undefined'
            ? `?q=${search || ''}&tab=${tab}&exhibitionPage=${exhibitionPage-1}${q && q.sort ? `&sort=${q.sort}` : ''}${q && q.type ? `&type=${q.type}` : ''}${q && q.minDate ? `&minDate=${q.minDate}` : ''}${q && q.maxDate ? `&maxDate=${q.maxDate}` : ''}${q && q.minYear && !q.minDate ? `&minDate=${q.minYear}-01-01` : ''}${q && q.maxYear && !q.maxDate ? `&maxDate=${q.maxYear}-12-31` : ''}`
            : `?exhibitionPage=${exhibitionPage-1}${q && q.sort ? `&sort=${q.sort}` : ''}${q && q.type ? `&type=${q.type}` : ''}${q && q.minDate ? `&minDate=${q.minDate}` : ''}${q && q.maxDate ? `&maxDate=${q.maxDate}` : ''}${q && q.minYear && !q.minDate ? `&minDate=${q.minYear}-01-01` : ''}${q && q.maxYear && !q.maxDate ? `&maxDate=${q.maxYear}-12-31` : ''}`)
          aria-label="Anterior")
          span(aria-hidden="true") «
      - var startPage = Math.max(1, exhibitionPage - 2);
      - var endPage = Math.min(exhibitionTotalPages, exhibitionPage + 2);
      - if (endPage - startPage < 4) {
      -   if (startPage === 1) endPage = Math.min(exhibitionTotalPages, startPage + 4);
      -   else if (endPage === exhibitionTotalPages) startPage = Math.max(1, endPage - 4);
      - }
      each p in Array(endPage - startPage + 1).fill().map((_,i) => startPage + i)
        li.page-item(class=p === exhibitionPage ? 'active' : '')
          a.page-link(
            href=(typeof tab !== 'undefined' && typeof search !== 'undefined'
              ? `?q=${search || ''}&tab=${tab}&exhibitionPage=${p}${q && q.sort ? `&sort=${q.sort}` : ''}${q && q.type ? `&type=${q.type}` : ''}${q && q.minDate ? `&minDate=${q.minDate}` : ''}${q && q.maxDate ? `&maxDate=${q.maxDate}` : ''}${q && q.minYear && !q.minDate ? `&minDate=${q.minYear}-01-01` : ''}${q && q.maxYear && !q.maxDate ? `&maxDate=${q.maxYear}-12-31` : ''}`
              : `?exhibitionPage=${p}${q && q.sort ? `&sort=${q.sort}` : ''}${q && q.type ? `&type=${q.type}` : ''}${q && q.minDate ? `&minDate=${q.minDate}` : ''}${q && q.maxDate ? `&maxDate=${q.maxDate}` : ''}${q && q.minYear && !q.minDate ? `&minDate=${q.minYear}-01-01` : ''}${q && q.maxYear && !q.maxDate ? `&maxDate=${q.maxYear}-12-31` : ''}`)
            aria-current=(p === exhibitionPage ? 'page' : false))= p
      li.page-item(class=exhibitionPage === exhibitionTotalPages ? 'disabled' : '')
        a.page-link(
          href=(typeof tab !== 'undefined' && typeof search !== 'undefined'
            ? `?q=${search || ''}&tab=${tab}&exhibitionPage=${exhibitionPage+1}${q && q.sort ? `&sort=${q.sort}` : ''}${q && q.type ? `&type=${q.type}` : ''}${q && q.minDate ? `&minDate=${q.minDate}` : ''}${q && q.maxDate ? `&maxDate=${q.maxDate}` : ''}${q && q.minYear && !q.minDate ? `&minDate=${q.minYear}-01-01` : ''}${q && q.maxYear && !q.maxDate ? `&maxDate=${q.maxYear}-12-31` : ''}`
            : `?exhibitionPage=${exhibitionPage+1}${q && q.sort ? `&sort=${q.sort}` : ''}${q && q.type ? `&type=${q.type}` : ''}${q && q.minDate ? `&minDate=${q.minDate}` : ''}${q && q.maxDate ? `&maxDate=${q.maxDate}` : ''}${q && q.minYear && !q.minDate ? `&minDate=${q.minYear}-01-01` : ''}${q && q.maxYear && !q.maxDate ? `&maxDate=${q.maxYear}-12-31` : ''}`)
          aria-label="Following")
          span(aria-hidden="true") »

