extends ../layouts/public

block content
  section.page-header.py-4
    .container
      h2.h3.mb-1 Resultados de búsqueda
      if search
        p.text-muted.mb-0 Buscando: "#{search}"
      else
        p.text-muted.mb-0 Ingresa un término para buscar obras, artistas o exposiciones.


  .container-xxl.my-4
    // Tabs
    - const artworksCount = typeof totalArtworks !== 'undefined' ? totalArtworks : (artworks ? artworks.length : 0);
    - const artistsCount = typeof totalArtists !== 'undefined' ? totalArtists : (artists ? artists.length : 0);
    - const exhibitionsCount = exhibitions ? exhibitions.length : 0;
    - const totalCount = artworksCount + artistsCount + exhibitionsCount;
    ul.nav.nav-tabs.mb-4#searchTabs(role="tablist")
      li.nav-item.flex-fill.text-center
        a.nav-link.active.w-100(href="#tab-obras", data-bs-toggle="tab", data-ox-tab="obras", role="tab", data-bs-target="#tab-obras") Obras (#{artworksCount})
      li.nav-item.flex-fill.text-center
        a.nav-link.w-100(href="#tab-artistas", data-bs-toggle="tab", data-ox-tab="artistas", role="tab", data-bs-target="#tab-artistas") Artistas (#{artistsCount})
      li.nav-item.flex-fill.text-center
        a.nav-link.w-100(href="#tab-exposiciones", data-bs-toggle="tab", data-ox-tab="exposiciones", role="tab", data-bs-target="#tab-exposiciones") Exposiciones (#{exhibitionsCount})

    // Tab Contents
    .tab-content

      // OBRAS TAB
      .tab-pane.active#tab-obras
        // Filtros solo visibles en el tab Obras
        section.filters-toolbar.py-2
          .container-xxl.d-flex.align-items-center.flex-wrap.gap-2
            // Set variables before including the filter fragment
            - var q = typeof q !== 'undefined' ? q : {};
            - var materials = typeof materials !== 'undefined' ? materials : [];
            - var priceBounds = typeof priceBounds !== 'undefined' ? priceBounds : {};
            - var appliedPrice = typeof appliedPrice !== 'undefined' ? appliedPrice : {};
            - var actionUrl = '/search';
            include _artworkFilters.pug
        .container-xxl.artworks-flex
          if artworks && artworks.length
            .artworks-grid-paginate
              include _artworkGrid.pug
              include _artworkPagination.pug
          else
            h3.h5.mt-4.text-muted No se encontraron obras.

      // ARTISTAS TAB
      .tab-pane#tab-artistas
        // Filtros solo visibles si hay resultados en el tab Artistas
        if artistsCount > 0
          section.filters-toolbar.py-2
            .container-xxl.d-flex.align-items-center.flex-wrap.gap-2
              - var q = typeof q !== 'undefined' ? q : {};
              - var actionUrl = '/search';
              include _artistFilters.pug
        .container-xxl.artworks-flex
          if artists && artists.length
            .artworks-grid-paginate
              include _artistGrid.pug
              - var page = typeof artistPage !== 'undefined' ? artistPage : 1;
              - var totalPages = typeof artistTotalPages !== 'undefined' ? artistTotalPages : 1;
              - var tab = 'artistas';
              include _artistPagination.pug
          else
            h3.h5.mt-4.text-muted No se encontraron artistas.

      // EXPOSICIONES TAB
      .tab-pane#tab-exposiciones
        if exhibitionsCount
          .container-xxl.artworks-flex
            include _exhibitionGrid.pug
        else
          h3.h5.mt-4.text-muted No se encontraron exposiciones.
