

// Filtros de exposiciones reutilizables para searchResults.pug
div.container-xxl.d-flex.align-items-center.flex-wrap.gap-2
  form#quickChips(method='GET' action=actionUrl class='d-flex flex-wrap gap-2')
    input(type='hidden' name='tab' value='exposiciones')
    // Mantener el término de búsqueda si existe
    if typeof search !== 'undefined' && search
      input(type='hidden' name='q' value=search)
    else if q && q.q
      input(type='hidden' name='q' value=q.q)
    // Chips de tipo de exposición (solo Física y Virtual)
    - var typeOpts = [{label: 'Todas', value: ''}, {label: 'Presenciales', value: 'physical'}, {label: 'Virtuales', value: 'virtual'}];
    each opt in typeOpts
      button.chip.btn(type='submit', name='type', value=opt.value, class=((!q || !q.type) && opt.value === '' ? 'active' : (q && q.type === opt.value ? 'active' : '')))= opt.label
    // No mostrar botones Limpiar/Ver resultados aquí (solo en offcanvas)
  // Botón Filtros fuera del form para evitar submit accidental y asegurar funcionalidad
  button.btn.btn-outline-secondary.ms-auto(
    type='button'
    data-bs-toggle='offcanvas'
    data-bs-target='#exhibitionFiltersDrawer'
    aria-controls='exhibitionFiltersDrawer'
  )
    i.fa-solid.fa-filter.me-1
    | Filtros

div.offcanvas.offcanvas-end#exhibitionFiltersDrawer(tabindex='-1' aria-labelledby='filtersTitle')
  .offcanvas-header
    h5#filtersTitle Filtros
    button.btn-close(type='button' data-bs-dismiss='offcanvas' aria-label='Cerrar')
  form.offcanvas-body.d-flex.flex-column.gap-4(method='GET' action=actionUrl)
    input(type='hidden' name='tab' value='exposiciones')
    // Mantener el término de búsqueda si existe
    if typeof search !== 'undefined' && search
      input(type='hidden' name='q' value=search)
    else if q && q.q
      input(type='hidden' name='q' value=q.q)
    // Filtro: año de inicio de la exposición
    .filter-block
      label.form-label.mb-2 Año de inicio
      .row.g-2
        .col-6
          input.form-control(type='number' name='minYear' placeholder='Año mín.' value=(q && q.minYear ? q.minYear : ''))
        .col-6
          input.form-control(type='number' name='maxYear' placeholder='Año máx.' value=(q && q.maxYear ? q.maxYear : ''))
    // Ordenar por fecha de inicio
    .filter-block
      label.form-label.mb-2 Ordenar por fecha
      select.form-select(name='sort')
        option(value='') Selecciona
        option(value='recent' selected=(q && q.sort==='recent')) Más recientes
        option(value='oldest' selected=(q && q.sort==='oldest')) Más antiguas
    .mt-auto.d-flex.gap-2.sticky-apply
      a.btn.btn-light.flex-fill(href=actionUrl) Limpiar
      button.btn.btn-apply.flex-fill(type='submit') Ver resultados
