

// Filtros de exposiciones reutilizables para searchResults.pug
div.container-xxl.d-flex.align-items-center.flex-wrap.gap-2
  form#quickChips(method='GET' action=actionUrl class='d-flex flex-wrap gap-2')
    // Mantener el término de búsqueda si existe
    if typeof search !== 'undefined' && search
      input(type='hidden' name='q' value=search)
    else if q && q.q
      input(type='hidden' name='q' value=q.q)
    // Chips de tipo de exposición (solo Física y Virtual)
    - var typeOpts = [{label: 'Física', value: 'physical'}, {label: 'Virtual', value: 'virtual'}];
    each opt in typeOpts
      button.chip.btn(
        type='submit'
        name='type'
        value=opt.value
        class=(q && q.type === opt.value ? 'active' : '')
      )= opt.label
    // No mostrar botones Limpiar/Ver resultados aquí (solo en offcanvas)
  // Botón Filtros fuera del form para evitar submit accidental y asegurar funcionalidad
  button.btn.btn-outline-secondary.ms-auto(
    type='button'
    data-bs-toggle='offcanvas'
    data-bs-target='#exhibitionFiltersDrawer'
    aria-controls='exhibitionFiltersDrawer'
  )
    i.fa-solid.fa-filter.me-1
    | Filtros

div.offcanvas.offcanvas-end#exhibitionFiltersDrawer(tabindex='-1' aria-labelledby='filtersTitle')
  .offcanvas-header
    h5#filtersTitle Filtros
    button.btn-close(type='button' data-bs-dismiss='offcanvas' aria-label='Cerrar')
  form.offcanvas-body.d-flex.flex-column.gap-4(method='GET' action=actionUrl)
    // Mantener el término de búsqueda si existe
    if typeof search !== 'undefined' && search
      input(type='hidden' name='q' value=search)
    else if q && q.q
      input(type='hidden' name='q' value=q.q)
    // Filtro: tipo de exposición (solo Física y Virtual)
    .filter-block
      label.form-label.mb-2 Tipo de exposición
      .d-flex.flex-wrap.gap-2
        - var typeOpts = [{label: 'Física', value: 'physical'}, {label: 'Virtual', value: 'virtual'}];
        each opt in typeOpts
          label.chip
            input(type='checkbox' name='type' value=opt.value checked=(Array.isArray(q && q.type) ? q.type.includes(opt.value) : (q && q.type) === opt.value))
            span= opt.label
    .mt-auto.d-flex.gap-2.sticky-apply
      a.btn.btn-light.flex-fill(href=actionUrl) Limpiar
      button.btn.btn-apply.flex-fill(type='submit') Ver resultados
